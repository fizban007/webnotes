<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2020-04-15 Wed 11:03 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Magnetar Resonant Scattering</title>
<meta name="generator" content="Org mode">
<meta name="author" content="Alex Chen">
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="org.min.css" />
<script type="text/javascript">
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.cacheClassElem = elem.className;
         elem.cacheClassTarget = target.className;
         target.className = "code-highlighted";
         elem.className   = "code-highlighted";
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(elem.cacheClassElem)
         elem.className = elem.cacheClassElem;
       if(elem.cacheClassTarget)
         target.className = elem.cacheClassTarget;
     }
    /*]]>*///-->
// @license-end
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<header>
<h1 class="title">Magnetar Resonant Scattering</h1>
</header>
<div id="outline-container-org35bdb62" class="outline-2">
<h2 id="org35bdb62"><span class="section-number-2">1</span> Resonant drag force</h2>
<div class="outline-text-2" id="text-1">
<p>
The resonant drag force is a complicated function that depends on the particle
position and Lorentz factor, stellar temperature, and local B field. It is not
necessarily intuitive how it behaves under different circumstances. This
document is trying to build some intuition on how it works, and what is the
implication in various cases.
</p>

<p>
Just to recap, the radiation drag force that we are considering is from
Beloborodov (2013):
</p>

<p>
\[
\mathcal{F}(\beta) = \frac{dp}{dt} = \frac{\alpha^2}{4
\tilde{r}^2}\frac{m_ec^2}{r_e}\Theta^3g(y)\gamma(\beta_{*} - \beta)
\]
</p>

<p>
where \(\Theta = kT_{*}/m_ec^2\) is the stellar temperature, \(g(y) = y^3/(e^y -
1)\), and \(y = b/[\gamma(1 - \beta\mu)\Theta]\). \(\mu\) is basically the local
angle between \(B\) field and the radial direction (from which all thermal photons
are coming from). \(\beta\) is the local parallel velocity in units of \(c\). We can
cast this into dimensionless form as:
</p>

<p>
\[
\tilde{\mathcal{F}}(\beta) = \frac{d\tilde{p}}{d\tilde{t}} = \frac{\alpha^2}{4
\tilde{r}^2}\frac{m_ec^2}{r_e}\Theta^3g(y)\gamma(\beta_{*} -
\beta)\frac{R_{*}}{m_ec^2} \sim 4.44\times 10^{13} \frac{1}{\tilde{r}^2}\Theta^3g(y)\gamma(\beta_{*} -
\beta)
\]
</p>

<p>
If we assume \(\Theta \sim 10^{-3}\) then \(\tilde{\mathcal{F}} \sim 4.7\times
10^{4}\) when other factors are of order unity, which is close to the estimate in
Beloborodov 2013.
</p>
</div>
</div>

<div id="outline-container-orge29c22f" class="outline-2">
<h2 id="orge29c22f"><span class="section-number-2">2</span> Resonant drag force vs radius</h2>
<div class="outline-text-2" id="text-2">
<p>
I want to get an intuitive idea of how this force behaves at different locations
in the magnetosphere. To this end, I wrote a python script to compute the
radiation drag force on a given particle with constant Lorentz factor moving
<b>outwards</b> from the stellar surface to \(R_\mathrm{max}\) on a specific field
line. Everything is in realistic parameters, namely \(\Theta = 10^{-3}\), \(F_0 =
4.7\times 10^{13}\), \(b = 10\) at the equator, and \(R_\mathrm{max} = 15R_{*}\) so
that we are in the radiative zone. The result is in the following plot:
</p>


<figure>
<img src="./drag_outgoing.png" alt="drag_outgoing.png">

<figcaption><span class="figure-number">Figure 1: </span>The resonant drag force on a single outgoing particle at various Lorentz factors</figcaption>
</figure>

<p>
There is an additional curve which is at \(\gamma = \gamma_\mathrm{thr}\), where
the threshold is defined to be \(\gamma_\mathrm{thr} = 100b\). What is curious is
that if the particle moves out constantly at \(\gamma_\mathrm{thr}\) it actually
doesn&rsquo;t feel any radiation drag at all. This is very surprising. My
understanding is that the threshold represents a &ldquo;lower bound&rdquo; on the Lorentz
factor at which pairs start to be produced. When \(\gamma\) goes above the
threshold, the drag rapidly becomes significant and manifests as discrete
scatterings that reduces the particle energy in chunks, way before the peak of
the thermal spectrum (and peak of the drag force).
</p>

<p>
Now consider the particle moving <b>backwards</b> from the apex of the dipole field
line to the star. The only difference here is that when computing \(\beta\) under
a given \(\gamma\) I added a negative sign in the force equation.
</p>


<figure>
<img src="./drag_incoming.png" alt="drag_incoming.png">

<figcaption><span class="figure-number">Figure 2: </span>The resonant drag force on a single in-going particle at various Lorentz factors</figcaption>
</figure>

<p>
There are several features. First, at any given radius and given Lorentz factor,
the drag force is about an order of magnitude higher than the outgoing case.
This is not surprising because the particles interact with a different portion
of the Wien tail, effectively increasing a lot the number of background photons
that the backflowing particles can scatter with. Secondly, the drag is very
efficient. Taking an &ldquo;integral&rdquo; of this force over radius (ignoring field line
geometry), the particle would be stopped way before it reaches the peak of
resonant drag. Also, near \(\gamma_\mathrm{thr}\) the force is rather huge near
the star. The voltage drop between \(R_{*}\) and \(2R_{*}\) is much higher than
\(m_i/m_e\). If this kind of voltage is around then there should be no problem
extracting ions.
</p>

<p>
Now suppose the system needs to sustain a backflow of electrons from the
equatorial cloud to the stellar surface in the upper hemisphere. I find it hard
to believe that the system prefers to accelerate the electrons to higher and
higher energies closer to the star, rather than to overcome a relatively small
potential barrier near the equator, then let the electrons almost free-stream
towards the star at relatively low energies. It also seems that the backflowing
particles interact with a different side of the peak radiation force, therefore
the qualitative behavior of backflowing plasma can be very different from the
outgoing plasma.
</p>

<p>
Also to put these numbers on the y-axis into context. In these dimensionless
units, 1 corresponds to about \(10^{-5}\) statV/cm. So if the parallel electric
field can be as strong as the poloidal \(B\) field, then it should have no problem
accelerating particles even to overcome the highest radiation drag. I doubt that
would be the case, as even in vacuum the parallel \(E\) field won&rsquo;t grow to \(B\)
levels, and we are mostly talking about small deviations of FFE and long-term
Ohmic evolution.
</p>
</div>
</div>

<div id="outline-container-org98aefa2" class="outline-2">
<h2 id="org98aefa2"><span class="section-number-2">3</span> Resonant scattering rates</h2>
<div class="outline-text-2" id="text-3">
<p>
The number of photons scattered per unit time is given by
</p>

<p>
\[
\dot{N}_\mathrm{sc} = \frac{2\pi^2 r_ec^2}{\gamma}\int d\Omega \int d\omega\
n_{\omega}\delta(\omega - \omega_\mathrm{res})
\]
</p>

<p>
where \(\omega_\mathrm{res} = \gamma(1 - \boldsymbol{\beta}\cdot
\boldsymbol{\Omega})\omega_B\). Assuming thermal soft X-ray background, the soft
photon density can be written as a Plankian:
</p>

<p>
\[ \omega n_{\omega} \approx 0.42 \frac{y^3}{e^y - 1} n_0 f(\Omega),\qquad y =
\frac{h\omega}{kT} \]
</p>

<p>
The dimensionless scattering rate can be written as
</p>

<p>
\[
\tilde{\dot{N}}_\mathrm{sc} = \frac{\alpha m_ec^2}{4\hbar}\frac{R_{*}}{c}
\Theta^2 \frac{g(y)}{y}\frac{1}{\tilde{r}^2}\frac{1}{\gamma} \approx
4.7\times 10^{13}\Theta^2 \frac{g(y)}{y}\frac{1}{\tilde{r}^2}\frac{1}{\gamma}
\]
</p>
</div>
</div>


<div id="outline-container-org5ccd05c" class="outline-2">
<h2 id="org5ccd05c"><span class="section-number-2">4</span> Parameters in the simulation</h2>
<div class="outline-text-2" id="text-4">
<p>
I want to write a mirroring section that do the same thing for simulation
parameters. However I want to make sure the above is correct before proceeding.
The above analysis also qualitatively explains what is happening in the
simulations so I would expect similar results to hold for simulation parameter
choices (I was really careful choosing those).
</p>
</div>
</div>
</div>
</body>
</html>
